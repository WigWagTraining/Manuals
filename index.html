<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>WigWag Training — Manuals</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;max-width:1000px;margin:2rem auto;padding:0 1rem;line-height:1.5}
    header{display:flex;justify-content:space-between;align-items:center;gap:1rem;flex-wrap:wrap}
    h1{margin:0}
    input{width:100%;padding:.6rem;font-size:1rem;margin:.75rem 0}
    ul{list-style:none;padding:0;margin:1rem 0}
    li{padding:.4rem 0;border-bottom:1px solid #eee}
    .muted{color:#666;font-size:.9rem}
    .err{color:#b91c1c}
  </style>
</head>
<body>
  <header>
    <h1>WigWag Training — Manuals</h1>
    <a href="https://wigwagtraining.com" target="_blank" rel="noopener">Main site →</a>
  </header>

  <p class="muted">Tip: you can add <code>#page=7</code> to any link to jump to a page.</p>

  <input id="q" type="search" placeholder="Filter by filename or folder…" />
  <div id="status">Loading…</div>
  <ul id="list"></ul>

  <script>
    // Set these exactly:
    const OWNER = "WigWag Training";
    const REPO  = "Manuals";

  
    const API  = `https://api.github.com/repos/${OWNER}/${REPO}/git/trees/HEAD?recursive=1`;

    const BASE = "https://wigwagtraining.github.io/Manuals";

    function niceName(p){
      return p.split('/').pop().replace(/[-_]+/g,' ').replace(/\.pdf$/i,'');
    }

    const status = document.getElementById('status');
    const list   = document.getElementById('list');

    fetch(API, { headers: { "Accept": "application/vnd.github+json" } })
      .then(r => r.ok ? r.json() : Promise.reject(`${r.status} ${r.statusText}`))
      .then(data => {
        if (!data.tree) { status.textContent = "No files found."; return; }
        const pdfs = data.tree
          .filter(n => n.type === "blob" && /\.pdf$/i.test(n.path))
          .map(n => ({
            path: n.path,
            url:  `${BASE}/${encodeURI(n.path)}`,
            name: niceName(n.path)
          }))
          .sort((a,b) => a.path.localeCompare(b.path));

        status.textContent = `${pdfs.length} PDF(s)`;
        const frag = document.createDocumentFragment();
        for (const f of pdfs) {
          const li = document.createElement('li');
          li.innerHTML = `
            <a href="${f.url}" target="_blank" rel="noopener">${f.name}</a>
            <div class="muted">${f.path}</div>
          `;
          frag.appendChild(li);
        }
        list.appendChild(frag);

        const q = document.getElementById('q');
        q.addEventListener('input', e => {
          const term = e.target.value.toLowerCase();
          [...list.children].forEach(li => {
            li.style.display = li.textContent.toLowerCase().includes(term) ? "" : "none";
          });
        });
      })
      .catch(err => {
        status.innerHTML = `<span class="err">Error loading file list:</span> ${err}`;
        console.error(err);
      });
  </script>
</body>
</html>
